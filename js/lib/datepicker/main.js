"use strict";define(["text!./main.htm","css!./style.css"],function(a){function e(a,e){var o=+a.calendar.year,c=+a.calendar.month,i=m(o,c),u=1-d(o,c),l=n(a.calendar,o,c);a.calendar.list.clear();for(var f=u;f<=i;f++){var s={weeken:!1,day:"",selected:!1,disable:!0};if(f>0){var h=d(o,c,f);s={weeken:0==h||6==h,day:f,selected:r(a.calendar,e,f),disable:t(a.calendar,f,l)}}a.calendar.list.push(s)}}function n(a,e,n){var t={Y:+a.minYear,M:+a.minMonth,mY:+a.maxYear,mM:+a.maxMonth},r="";if(!t.Y&&!t.mY||!t.M&&!t.mM||!e)return!1;if(t.Y&&e<t.Y||t.mY&&e>t.mY)return!0;if(n){if(e===t.Y){if(t.M&&n<t.M)return!0;n==t.M&&(r+="-")}if(e===t.mY){if(t.mM&&n>t.mM)return!0;n==t.mM&&(r+="+")}}return r}function t(a,e,n){var t=a.minDay,r=a.maxDay;return"-"===n?e<t:"+"===n?r&&e>r:"-+"===n?e<t||r&&e>r:n}function r(a,e,n){var t=+a.year,r=+a.month;return!(e.year!==t||e.month!==r||e.day!==n)}function o(a,e){a.list.forEach(function(a){a.day!=e?a.selected=!1:a.selected=!0})}function c(a,e){var n=0,t=0,r=0;e={year:+a.calendar.year,month:+a.calendar.month,day:+a.calendar.day},a.showTime&&(n=a.calendar.hour,t=a.calendar.minute,r=a.calendar.second),a.value=new Date(e.year,e.month-1,e.day,n,t,r).format(a.format)}function m(a,e){return new Date(a,e,0).getDate()}function d(a,e,n){return new Date(a,e-1,n||1).getDay()}function i(a,e){if((a+="").length===e)return a;for(;a.length<e;)a="0"+a;return a}return yua.ui.datepicker="1.0.0",yua.component("datepicker",{$template:a,$construct:function(a,e,n){var t,r=Object.assign({},e,n);return r.value?(t=a.$up[r.value],r.showTime||r.format||(r.format="Y-m-d"),t||(t=r.minDate?r.minDate:r.maxDate?r.maxDate:new Date),Date.isDate(t)||(t=new Date(t)),r.update_value=r.value,r.value=t.format(r.format),r.calendar={list:[1],year:t.format("Y"),month:t.format("m"),day:t.format("d"),hour:t.format("H"),minute:t.format("i"),second:t.format("s"),minYear:0,minMonth:0,minDay:0,maxYear:0,maxMonth:0,maxDay:0},r.minDate&&(Date.isDate(r.minDate)||(r.minDate=new Date(r.minDate)),r.calendar.minYear=r.minDate.format("Y"),r.calendar.minMonth=r.minDate.format("m"),r.calendar.minDay=r.minDate.format("d")),r.maxDate&&(Date.isDate(r.maxDate)||(r.maxDate=new Date(r.maxDate)),r.calendar.maxYear=r.maxDate.format("Y"),r.calendar.maxMonth=r.maxDate.format("m"),r.calendar.maxDay=r.maxDate.format("d")),delete r.minDate,delete r.maxDate,yua.mix(a,r)):yua.error("日历组件必须设置value属性")},$ready:function(a,r){var m,d={year:+a.calendar.year,month:+a.calendar.month,day:+a.calendar.day};e(a,d),a.$turn=function(e,t){var r=+a.calendar.year,o=+a.calendar.month;1===e?r+=t:((o+=t)<1&&(o=12,r--),o>12&&(o=1,r++)),!0!==n(a.calendar,r,o)?(a.calendar.year=r,a.calendar.month=i(o,2)):a.tips="日期超出限制"},a.$getDate=function(e,n){e||(a.calendar.day=n,o(a.calendar,n),c(a,d),a.showCalendar=!1)},a.$focus=function(){a.showCalendar=!0},a.$now=function(){var e=new Date,r=e.format("Y"),m=e.format("m"),i=e.format("d");t(i,n(r,m))?a.tips="今天超出了限制日期":(a.calendar.year=r,a.calendar.month=m,a.calendar.day=i,a.calendar.hour=e.format("H"),a.calendar.minute=e.format("i"),a.calendar.second=e.format("s"),o(a.calendar,i),c(a,d),a.showCalendar=!1)},a.$watch("calendar.year",function(){e(a,d)}),a.$watch("calendar.month",function(){e(a,d)}),a.$watch("calendar.hour",function(e){a.calendar.hour=e,c(a,d)}),a.$watch("calendar.minute",function(e){a.calendar.minute=e,c(a,d)}),a.$watch("calendar.second",function(e){a.calendar.second=e,c(a,d)}),a.$watch("showCalendar",function(e){!e&&a.value&&(a.$up[a.update_value]=a.value,a.$onUpdate(a.value))}),a.$watch("tips",function(e){e&&(clearTimeout(m),m=setTimeout(function(){a.tips=""},1500))}),document.addEventListener("click",function(){a.showCalendar=!1})},showTime:!1,showCalendar:!1,disabled:!1,tips:"",format:"",value:"",$prevYear:"<<",$nextYear:">>",$prevMonth:"<",$nextMonth:">",$focus:yua.noop,$turn:yua.noop,$getDate:yua.noop,$now:yua.noop,$cancelBubble:function(a){a.stopPropagation&&a.stopPropagation()||(a.cancelBubble=!0)},$onUpdate:yua.noop}),yua});