"use strict";define(["yua", "lib/drag", "css!./skin/def"],function(t){function i(){return"layer-"+ ++s}function n(i){i&&"string"==typeof i||(i="layer-"+s);try{document.body.removeChild(e[i][1]),document.body.removeChild(e[i][0])}catch(n){}delete e[i],delete t.vmodels[i]}var e={},s=0,o={type:{1:"alert",2:"confirm",3:"prompt",4:"iframe",5:"tips",6:"loading",7:"msg"},init:{type:1,icon:1,shade:!0,shadeClose:!1,move:".do-ui-layer-move",zIndex:65535,title:"",content:"",offset:{x:"300px",y:"200px"},btns:["确定","取消"],yes:n,no:n,success:n}},c=function(t){this.ready(t)},r={alert:function(t,i){return i=i||{},i.content=t,r.open(i)},confirm:function(t,i){return i=i||{},i.type=2,i.icon=3,i.content=t,r.open(i)},msg:function(i){t.log(i)},loading:function(i){t.log(i)},iframe:function(i){t.log(i)},tips:function(i){t.log(i)},prompt:function(i,n){if("function"!=typeof n)return console.error("argument [callback] requires a function, but "+typeof n+" given");var e={type:3,icon:6,prompt:"",title:i,content:'<input class="prompt-value" :duplex="prompt" />',yes:function(i){n(i,t.vmodels[i].prompt)}};return r.open(e)},use:function(t,i){require(["css!./skin/"+t.skin],i)},close:n,open:function(t){return new c(t).init.$id}};return c.prototype={init:{},cInit:{},create:function(){var t=document.createElement("div"),i=document.createElement("div");return i.className="do-ui-layer-cover",this.init.shadeClose&&(i.setAttribute(":controller",this.cInit.$id),i.setAttribute(":click","close")),t.className="do-ui-layer skin-def type-"+this.init.type,t.style.left=this.init.offset.x,t.style.top=this.init.offset.y,t.setAttribute(":controller",this.init.$id),t.innerHTML=this.getTitle()+'<div class="layer-content do-fn-cl">'+this.getIcon()+'<div class="detail" :html="content"></div></div>'+this.getBtns(),[this.init.shade?i:null,t]},getTitle:function(){return this.init.type>3?"":'<div class="layer-title do-fn-noselect" data-limit="window" :drag="do-ui-layer">{{title}}<a class="action-min deficon"></a><a class="action-close deficon" :click="no(\''+this.init.$id+"')\"></a></div>"},getIcon:function(){return this.init.type>3&&5!==this.init.type?"":'<span class="deficon icon-'+this.init.icon+'"></span>'},getBtns:function(){if(this.init.type>3)return"";var t='<div class="layer-btns do-fn-noselect">';return t+=this.init.type>1?'<a href="javascript:;" class="action-no" :click="no(\''+this.init.$id+'\')" :text="btns[1]"></a><a href="javascript:;" class="action-yes" :click="yes(\''+this.init.$id+'\')" :text="btns[0]"></a>':'<a href="javascript:;" class="action-yes" :click="yes(\''+this.init.$id+'\')" :text="btns[0]"></a>',t+="</div>"},show:function(){e[this.init.$id]=this.create(),e[this.init.$id][0]&&(document.body.appendChild(e[this.init.$id][0]),this.init.shadeClose&&(t.define(this.cInit),t.scan(e[this.init.$id][0]))),document.body.appendChild(e[this.init.$id][1]),t.define(this.init),t.scan(e[this.init.$id][1])},ready:function(e){this.init=t.mix(this.init,{$id:i()},o.init,e),this.cInit={$id:this.init.$id+"-c",close:this.init.shadeClose?n:t.noop},this.show()}},window.layer||(window.layer=r),r});