"use strict";define(["lib/layer/base"],function(){function e(e){for(var t=[];e>0;)t.push({v:0}),e--;return t}function t(e,t){return e.replace(new RegExp("^"+t+"|"+t+"$","g"),"")}function i(e){for(var t=[],i=0;i<e;)t.push(i++);return t}ME.addon={h1:function(e,t){var i=yua(e).offset(),n=ME.selection(t.$editor,!0)||"在此输入文本",o=layer.open({type:7,menubar:!1,shadeClose:!0,fixed:!0,$insert:function(e){n=n.replace(/^#{1,6} /,""),n=ME.repeat("#",e)+" "+n,ME.insert(t.$editor,n,!0),layer.close(o)},offset:[i.top+37-ME.doc.scrollTop(),"auto","auto",i.left-ME.doc.scrollLeft()],content:'<ul class="do-meditor-h1 do-fn-noselect meditor-font"><li :click="$insert(1)" class="h1">一级标题</li><li :click="$insert(2)" class="h2">二级标题</li><li :click="$insert(3)" class="h3">三级标题</li><li :click="$insert(4)" class="h4">四级标题</li><li :click="$insert(5)" class="h5">五级标题</li><li :click="$insert(6)" class="h6">六级标题</li></ul>'})},quote:function(e,t){var i=ME.selection(t.$editor)||"在此输入文本";i="> "+i,ME.insert(t.$editor,i,!0)},bold:function(e,i){var n=ME.selection(i.$editor)||"在此输入文本",o=t(n,"\\*\\*");n=n===o?"**"+n+"**":o,ME.insert(i.$editor,n,!0)},italic:function(e,i){var n=ME.selection(i.$editor)||"在此输入文本",o=t(n,"_");n=n===o?"_"+n+"_":o,ME.insert(i.$editor,n,!0)},through:function(e,i){var n=ME.selection(i.$editor)||"在此输入文本",o=t(n,"~~");n=n===o?"~~"+n+"~~":o,ME.insert(i.$editor,n,!0)},unordered:function(e,t){var i=ME.selection(t.$editor)||"在此输入文本";i="* "+i,ME.insert(t.$editor,i,!1)},ordered:function(e,t){var i=ME.selection(t.$editor)||"在此输入文本";i="1. "+i,ME.insert(t.$editor,i,!1)},hr:function(e,t){ME.insert(t.$editor,"\n\n---\n\n",!1)},link:function(e,t){var i=yua(e).offset(),n=ME.selection(t.$editor)||"",o=layer.open({type:7,menubar:!1,shadeClose:!0,fixed:!0,link:"",linkName:n,linkTarget:1,$confirm:function(){var e=yua.vmodels[o];if(!e.link||!e.linkName)return layer.alert("链接文字和地址不能为空");var i="["+e.linkName+"]("+e.link+(1===e.linkTarget?' "target=_blank"':"")+")";ME.insert(t.$editor,i,!1),layer.close(o)},offset:[i.top+37-ME.doc.scrollTop(),"auto","auto",i.left-ME.doc.scrollLeft()],content:'<div class="do-meditor-common meditor-font"><section><span class="label">链接文字</span><input class="input" :duplex="linkName" /></section><section><span class="label">链接地址</span><input class="input" :duplex="link"/></section><section><label><input name="link" type="radio" class="radio" :duplex-number="linkTarget" value="1"/> 新窗口打开</label><label><input name="link" type="radio" class="radio" :duplex-number="linkTarget" value="2"/> 本窗口打开</label></section><section><a href="javascript:;" class="submit" :click="$confirm">确定</a></section></div>'})},time:function(e,t){ME.insert(t.$editor,(new Date).format(),!1)},face:function(e,t){var n=yua(e).offset(),o=layer.open({type:7,title:"插入表情",fixed:!0,shadeClose:!0,arr:i(36),offset:[n.top+37-ME.doc.scrollTop(),"auto","auto",n.left-ME.doc.scrollLeft()],content:'<ul class="do-meditor-face"><li class="item" :repeat="arr" ><img :attr-src="ME.path + \'/addon/face/\' + el + \'.gif\'" :click="$insert(this.src)" /></li></ul>',$insert:function(e){ME.insert(t.$editor,"![]("+e+")",!1),layer.close(o)}})},table:function(t,i){var n=yua(t).offset();layer.open({type:7,title:"0行 x 0列",fixed:!0,shadeClose:!0,offset:[n.top+37-ME.doc.scrollTop(),"auto","auto",n.left-ME.doc.scrollLeft()],matrix:e(10).map(function(){return e(10)}),content:'<ul class="do-meditor-table"><li :repeat="matrix"><span :repeat-o="el" :class="{active: o.v}" :data="{x: $index, y: $outer.$index}"></span></li></ul>',success:function(e){var t,n,o=document.querySelector(".do-meditor-table"),a=yua.vmodels[e];yua(o).bind("mousemove",function(e){if("SPAN"===e.target.nodeName){var i=e.target.dataset.x-0,o=e.target.dataset.y-0;if(i===t&&o===n)return;t=i,n=o,a.title=o+1+"行 x "+(i+1)+"列";for(var l=0;l<=9;l++)for(var r=0;r<=9;r++)a.matrix[l][r].v=l<=o&&r<=i?1:0}}),yua(o).bind("mouseleave",function(e){t=-1,n=-1,a.title="0行 x 0列";for(var i=0;i<=9;i++)for(var o=0;o<=9;o++)a.matrix[i][o].v=0}),yua(o).bind("click",function(t){if("SPAN"===t.target.nodeName){var n=t.target.dataset.x-0+1,o=t.target.dataset.y-0+1,a="\n\n"+ME.repeat("| 表头 ",n)+"|\n"+ME.repeat("| -- ",n)+"|\n"+ME.repeat(ME.repeat("| ",n)+"|\n",o);ME.insert(i.$editor,a,!1),layer.close(e)}})}})},image:function(e,t){var i=yua(e).offset(),n=ME.selection(t.$editor)||"",o=layer.open({type:7,menubar:!1,shadeClose:!0,fixed:!0,img:"",imgAlt:n,$confirm:function(){var e=yua.vmodels[o];if(!e.img||!e.imgAlt)return layer.alert("图片描述和图片地址不能为空");var i="!["+e.imgAlt+"]("+e.img+")";ME.insert(t.$editor,i,!1),layer.close(o)},offset:[i.top+37-ME.doc.scrollTop(),"auto","auto",i.left-ME.doc.scrollLeft()],content:'<div class="do-meditor-common meditor-font"><section><span class="label">图片描述</span><input class="input" :duplex="imgAlt" /></section><section><span class="label">图片地址</span><input class="input" :duplex="img"/></section><section><a href="javascript:;" class="submit" :click="$confirm">确定</a></section></div>'})},file:function(e,t){this.link(e,t,!1)},inlinecode:function(e,t){var i=ME.selection(t.$editor)||"在此输入文本";i="`"+i+"`",ME.insert(t.$editor,i,!0)},blockcode:function(e,t){var i=layer.open({type:7,title:"添加代码块",$lang:[{id:"asp"},{id:"actionscript",name:"ActionScript(3.0)/Flash/Flex"},{id:"bash",name:"Bash/Shell/Bat"},{id:"css"},{id:"c",name:"C"},{id:"cpp",name:"C++"},{id:"csharp",name:"C#"},{id:"coffeescript",name:"CoffeeScript"},{id:"d",name:"D"},{id:"dart"},{id:"delphi",name:"Delphi/Pascal"},{id:"erlang"},{id:"go",name:"Golang"},{id:"html"},{id:"java"},{id:"javascript"},{id:"json"},{id:"lua"},{id:"less"},{id:"markdown"},{id:"nginx"},{id:"objective-c"},{id:"php"},{id:"perl"},{id:"python"},{id:"r",name:"R"},{id:"ruby"},{id:"sql"},{id:"sass",name:"SASS/SCSS"},{id:"swift"},{id:"typescript"},{id:"xml"},{id:"yaml"},{id:"other",name:"其他语言"}],lang:"javascript",code:"",$confirm:function(){var e=yua.vmodels[i],n="\n```"+e.lang+"\n"+(e.code||"//在此输入代码")+"\n```\n";ME.insert(t.$editor,n,!1),layer.close(i)},content:'<div class="do-meditor-codeblock meditor-font"><section><span class="label">语言类型</span><select :duplex="lang"><option :repeat="$lang" :attr-value="el.id">{{el.name || el.id}}</option></select></section><section><textarea :duplex="code" placeholder="在这里输入/粘贴代码"></textarea></section><section><a href="javascript:;" class="submit" :click="$confirm">确定</a></section></div>'})},preview:function(e,t){t.preview=!t.preview,t.preview&&(t.htmlTxt=t.$htmlTxt)},fullscreen:function(e,t){t.fullscreen=!t.fullscreen,t.$onFullscreen(t.fullscreen)},about:function(e){var t=yua(e).offset();layer.open({type:7,title:"关于编辑器",offset:[t.top+37-ME.doc.scrollTop()],content:'<div class="do-meditor-about meditor-font"><pre> __  __ _____    _ _ _\n|  \\/  | ____|__| (_) |_ ___  _ __\n| |\\/| |  _| / _` | | __/ _ \\| \'__|\n| |  | | |__| (_| | | || (_) | |\n|_|  |_|_____\\__,_|_|\\__\\___/|_|    v'+ME.version+'</pre><p>开源在线Markdown编辑器</p><p><a target="_blank" href="https://doui.cc/product/meditor">https://doui.cc/product/meditor</a></p><p>Copyright © 2017 Yutent, The MIT License.</p></div>'})}}});