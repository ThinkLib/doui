"use strict";define(["yua","css!./skin/def.css"],function(){function e(r,t){var c="";return r.forEach(function(r,l){var o=t+"["+l+"]",u="";c+=n.replace(/\{it\}/g,o),r.children&&(u+=e(r.children,o+".children"),u=i.replace("{li}",u).replace("{it}",o)),c=c.replace(/\{child\}/,u)}),c}function r(e){var r={},i=[];return e.sort(function(e,r){return e.pid===r.pid?e.sort-r.sort:e.pid-r.pid}),e.forEach(function(e){r[e.id]=e;var n=r[e.pid];if(delete e.pid,!n)return i.push(r[e.id]);n.open=!!n.open,n.children=n.children||[],n.children.push(e)}),r=e=null,i}yua.ui.tree="0.0.1";var i='<ul :class="{open: {it}.open}">{li}</ul>',n='<li :class="{open: {it}.open, dir: {it}.children}"><em :click="$toggle({it})"></em><span :click="$select({it})" :class="{active: {it}.id === currItem}" :text="{it}.name"></span>{child}</li>';return yua.component("tree",{$template:'<div class="do-tree" :class="{{$skin}}" :html="treeHTML"></div>',$init:function(i){i.$select=function(e){i.currItem=e.id,i.$onClick&&i.$onClick(e)},i.$update=function(n){i.treeArr.clear(),i.treeArr.pushArray(r(n)),i.currItem=-1;var t=e(i.treeArr.$model,"treeArr");i.treeHTML="<ul>{li}</ul>".replace("{li}",t)}},$ready:function(e){e.$onSuccess(e)},$skin:"skin-def",treeHTML:"",currItem:-1,treeArr:[],$select:yua.noop,$update:yua.noop,$onSuccess:yua.noop,$onClick:yua.noop,$toggle:function(e){e.open=!e.open}})});